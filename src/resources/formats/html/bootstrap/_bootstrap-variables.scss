/* Code Block Formatting */
// Code Block Border Treatment
$code-block-border-left: false !default;
$code-block-border-left-style: solid !default;
$code-block-border-left-size: 3px !default;
$code-block-padding-left: 0.6em !default;

// Code Block Background Treatment
// $code-block-bg, $code-block-bg-padding, $code-block-bg-alpha
$code-block-bg: true !default;
$code-block-bg-padding: 0.4em !default;
$code-block-bg-alpha: -0.35 !default;

// Controls when the code block will switch to a dark
// version of a theme
$code-block-theme-dark-threshhold: 40% !default;

/* Inline Code Formatting */
// $code-bg, $code-color, $code-padding
$code-color: #9753b8 !default;

$blue: #0d6efd !default;
$primary: $blue !default;
$link-color: $primary !default;
$gray-200: #e9ecef !default;

// toc variables
$toc-color: $link-color !default;
$toc-font-size: 0.875rem !default;
$toc-active-border: $toc-color !default;
$toc-inactive-border: $gray-200 !default;

/* Callout customization */
// Formatting
$callout-border-width: 5px !default;
$callout-border-scale: 0% !default;
$callout-icon-scale: 10% !default;
$callout-margin-top: 1.25rem !default;
$callout-margin-bottom: 1.25rem !default;

// Navbar
$theme-name: if(variable-exists(theme), $theme, "");
$navbar-default: if(variable-exists(primary), $primary, #517699);

// If the user provides a navbar-bg, we ned to ignore the
// theme overide and just recalculate a good value
$navbar-hl-override: if(
  variable-exists(navbar-bg) and variable-exists(link-color),
  theme-contrast($link-color, $navbar-bg),
  false
);
$navbar-bg: theme-override-value(
  $theme-name,
  "navbar-bg",
  $navbar-default
) !default;

$btn-bg: if(variable-exists(secondary), $secondary, #6c757d) !default;
$btn-fg: theme-contrast($btn-bg, $btn-bg) !default;

$white: #ffffff !default;
$gray-900: #212529 !default;
$body-contrast-bg: if(variable-exists(body-bg), $body-bg, $white);
$body-contrast-color: if(variable-exists(body-color), $body-color, $gray-900);
$navbar-fg: if(
  $navbar-bg == transparent,
  theme-override-value(
    $theme-name,
    "navbar-fg",
    theme-contrast($body-contrast-color, $body-contrast-bg)
  ),
  theme-override-value(
    $theme-name,
    "navbar-fg",
    theme-contrast($navbar-bg, $navbar-bg)
  )
) !default;

$navbar-hl: if(
  $navbar-hl-override != false,
  $navbar-hl-override,
  theme-override-value(
    $theme-name,
    "navbar-hl",
    if(
      variable-exists(link-color),
      theme-contrast($link-color, $navbar-bg),
      $navbar-fg
    )
  )
) !default;
$navbar-brand: theme-override-value(
  $theme-name,
  "navbar-brand",
  $navbar-fg
) !default;
$navbar-brand-hl: theme-override-value(
  $theme-name,
  "navbar-brand-hl",
  $navbar-hl
) !default;

$navbar-toggler-icon-bg: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke='#{$navbar-fg}' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg>");
$navbar-togger-border-color: rgba($navbar-fg, 0.4);
$navbar-hover-color: rgba($navbar-hl, 0.8);
$navbar-disabled-color: rgba($navbar-fg, 0.75);

// We omit the !default here b/c the dark and light variants
// are not meaningful in our usage of bootstrap. Instead, we will explicitly
// manage these using the above documented variables
$navbar-dark-bg: $navbar-bg;
$navbar-dark-color: $navbar-fg;
$navbar-dark-hover-color: $navbar-hover-color;
$navbar-dark-active-color: $navbar-hl;
$navbar-dark-disabled-color: $navbar-disabled-color;
$navbar-dark-toggler-icon-bg: $navbar-toggler-icon-bg;
$navbar-dark-toggler-border-color: $navbar-togger-border-color;

$navbar-light-bg: $navbar-bg;
$navbar-light-color: $navbar-fg;
$navbar-light-hover-color: $navbar-hover-color;
$navbar-light-active-color: $navbar-hl;
$navbar-light-disabled-color: $navbar-disabled-color;
$navbar-light-toggler-icon-bg: $navbar-toggler-icon-bg;
$navbar-light-toggler-border-color: $navbar-togger-border-color;

$navbar-light-brand-color: $navbar-brand;
$navbar-light-brand-hover-color: $navbar-brand-hl;
$navbar-dark-brand-color: $navbar-brand;
$navbar-dark-brand-hover-color: $navbar-brand-hl;

// Sidebar coloring
$sidebar-bg: if(variable-exists(light), $light, #fff) !default;
$sidebar-fg: null !default;
@if $sidebar-bg == transparent {
  $sidebar-fg: theme-contrast($body-contrast-color, $body-contrast-bg) !default;
} @else {
  $sidebar-fg: theme-contrast($sidebar-bg, $sidebar-bg) !default;
}
$sidebar-hl: null;
$sidebar-font-size: 0.925rem !default;
$sidebar-font-size-section: 0.875rem !default;
$sidebar-font-size-collapse: 1rem !default;
$sidebar-font-size-section-collapse: 1.1rem !default;
$sidebar-border: false !default;

// Title block variables
$title-block-color: $body-contrast-color !default;
$title-block-contast-color: $body-contrast-bg !default;
$title-block-padding-top: 2.5em !default;

// Footer coloring
$footer-bg: if(variable-exists(body-bg), $body-bg, #fff) !default;
$footer-fg: theme-contrast($footer-bg, $footer-bg, "AA") !default;
$footer-font-size: 0.825em !default;
$footer-left-font-size: $footer-font-size !default;
$footer-center-font-size: $footer-font-size !default;
$footer-right-font-size: $footer-font-size !default;

// Disable default grid system and switch to CSS grid
$enable-grid-classes: false;
$enable-cssgrid: true;

$zindex-pagelayout: 998;

$popover-bg: if(variable-exists(body-bg), $body-bg, null) !default;
$input-bg: if(variable-exists(body-bg), $body-bg, null) !default;

// Note that 'default' is intentionally omitted from this
// because we're using the default value if one is defined at this
// point (the if variable exists check in the default).
// This is a change to override the input border color for
// darkly, which sets the border color to the body color for
// whatever reason.
$input-border-color: theme-override-value(
  $theme-name,
  "input-border-color",
  if(variable-exists(input-border-color), $input-border-color, null)
);

/* GRID VARIABLES */
$grid-margin: 1.5em !default;
$grid-sidebar-column: 250px !default;
$grid-margin-column: 250px !default;

// body variables
$grid-body-column: 800px !default;
$grid-body-column-min: 500px !default;
$grid-body-column-max: $grid-body-column !default;

// Margin variables
$grid-page-margin: $grid-margin !default;
$grid-page-margin-start: $grid-page-margin !default;
$grid-page-margin-end: $grid-page-margin !default;

$grid-body-margin: $grid-margin !default;
$grid-body-margin-start: $grid-body-margin !default;
$grid-body-margin-end: $grid-body-margin !default;

/* FLOATING GRID */
$grid-page-margin-float: 5fr !default;
$grid-float-sidebar-column: $grid-sidebar-column !default;
$grid-float-margin-column: $grid-margin-column !default;

/* Float Wide Default Grid */

// Margins
$grid-float-wide-page-margin-start: $grid-page-margin-start !default;
$grid-float-wide-page-margin-end: $grid-page-margin-end !default;
$grid-float-wide-body-margin-start: $grid-body-margin-start !default;
$grid-float-wide-body-margin-end: $grid-body-margin-end !default;
$grid-float-wide-sidebar-margin: $grid-page-margin-float !default;
$grid-float-wide-margin-margin: $grid-page-margin-float !default;

// Sidebars
$grid-float-wide-sidebar-column: $grid-float-sidebar-column !default;
$grid-float-wide-sidebar-seg1: minmax(
  #{0.1 * $grid-float-wide-sidebar-column},
  #{0.2 * $grid-float-wide-sidebar-column}
) !default;
$grid-float-wide-sidebar-seg2: minmax(
  #{0.2 * $grid-float-wide-sidebar-column},
  #{0.6 * $grid-float-wide-sidebar-column}
) !default;
$grid-float-wide-sidebar-seg3: minmax(
  #{0.1 * $grid-float-wide-sidebar-column},
  #{0.2 * $grid-float-wide-sidebar-column}
) !default;

// Margins
$grid-float-wide-margin-column: $grid-float-margin-column !default;
$grid-float-wide-margin-seg3: minmax(
  #{0.1 * $grid-float-wide-margin-column},
  #{0.2 * $grid-float-wide-margin-column}
) !default;
$grid-float-wide-margin-seg2: minmax(
  #{0.2 * $grid-float-wide-margin-column},
  #{0.6 * $grid-float-wide-margin-column}
) !default;
$grid-float-wide-margin-seg1: minmax(
  #{0.1 * $grid-float-wide-margin-column},
  #{0.2 * $grid-float-wide-margin-column}
) !default;

// Body
$grid-float-wide-body-column-min: $grid-body-column-min !default;
$grid-float-wide-body-column-max: $grid-body-column-max !default;
$grid-float-wide-body: minmax(
  $grid-float-wide-body-column-min,
  calc(
    #{$grid-float-wide-body-column-max} - #{$grid-float-wide-page-margin-start +
      $grid-float-wide-page-margin-end}
  )
) !default;

/* Float Wide Slim Content Grid */

// Margins
$grid-float-wide-slim-page-margin-start: $grid-page-margin-start !default;
$grid-float-wide-slim-page-margin-end: $grid-page-margin-end !default;
$grid-float-wide-slim-body-margin-start: $grid-body-margin-start !default;
$grid-float-wide-slim-body-margin-end: $grid-body-margin-end !default;
$grid-float-wide-slim-sidebar-margin: $grid-page-margin-float !default;
$grid-float-wide-slim-margin-margin: $grid-page-margin-float !default;

// Sidebars
$grid-float-wide-slim-sidebar-column: $grid-float-sidebar-column !default;
$grid-float-wide-slim-sidebar-seg1: 0.2 * $grid-float-wide-slim-sidebar-column !default;
$grid-float-wide-slim-sidebar-seg2: minmax(
  #{0.2 * $grid-float-wide-slim-sidebar-column},
  #{0.6 * $grid-float-wide-slim-sidebar-column}
) !default;
$grid-float-wide-slim-sidebar-seg3: 0.2 * $grid-float-wide-slim-sidebar-column !default;

// Margins
$grid-float-wide-slim-margin-column: $grid-float-margin-column !default;
$grid-float-wide-slim-margin-seg3: 0.2 * $grid-float-wide-slim-margin-column !default;
$grid-float-wide-slim-margin-seg2: minmax(
  #{0.2 * $grid-float-wide-slim-margin-column},
  #{0.6 * $grid-float-wide-slim-margin-column}
) !default;
$grid-float-wide-slim-margin-seg1: 0.2 * $grid-float-wide-slim-margin-column !default;

// Body
$grid-float-wide-slim-body-column-min: $grid-body-column-min - 50px !default;
$grid-float-wide-slim-body-column-max: $grid-body-column-max - 50px !default;
$grid-float-wide-slim-body: minmax(
  $grid-float-wide-slim-body-column-min,
  calc(
    #{$grid-float-wide-slim-body-column-max} - #{$grid-float-wide-slim-page-margin-start +
      $grid-float-wide-slim-page-margin-end}
  )
) !default;

/* Float Wide Full Grid */
// Margins
$grid-float-wide-full-page-margin-start: $grid-page-margin-start !default;
$grid-float-wide-full-page-margin-end: $grid-page-margin-end !default;
$grid-float-wide-full-body-margin-start: $grid-body-margin-start !default;
$grid-float-wide-full-body-margin-end: $grid-body-margin-end !default;
$grid-float-wide-full-sidebar-margin: $grid-page-margin-float !default;
$grid-float-wide-full-margin-margin: $grid-page-margin-float !default;

// Sidebars
$grid-float-wide-full-sidebar-column: $grid-float-sidebar-column !default;
$grid-float-wide-full-sidebar-seg1: 0.2 * $grid-float-wide-full-sidebar-column !default;
$grid-float-wide-full-sidebar-seg2: minmax(
  #{0.2 * $grid-float-wide-full-sidebar-column},
  #{0.6 * $grid-float-wide-full-sidebar-column}
) !default;
$grid-float-wide-full-sidebar-seg3: 0.2 * $grid-float-wide-full-sidebar-column !default;

// Margins
$grid-float-wide-full-margin-column: $grid-float-margin-column !default;
$grid-float-wide-full-margin-seg3: 0.2 * $grid-float-wide-full-margin-column !default;
$grid-float-wide-full-margin-seg2: minmax(
  #{0.2 * $grid-float-wide-full-margin-column},
  #{0.6 * $grid-float-wide-full-margin-column}
) !default;
$grid-float-wide-full-margin-seg1: 0.2 * $grid-float-wide-full-margin-column !default;

// Body
$grid-float-wide-full-body-column-min: $grid-body-column-min !default;
$grid-float-wide-full-body-column-max: $grid-body-column-max !default;
$grid-float-wide-full-body: minmax(
  $grid-float-wide-full-body-column-min,
  calc(
    #{$grid-float-wide-full-body-column-max} - #{$grid-float-wide-full-page-margin-start +
      $grid-float-wide-full-page-margin-end}
  )
) !default;

/* Float Wide Listing Grid */
// Margins
$grid-float-wide-listing-page-margin-start: $grid-page-margin-start !default;
$grid-float-wide-listing-page-margin-end: $grid-page-margin-end !default;
$grid-float-wide-listing-body-margin-start: $grid-body-margin-start !default;
$grid-float-wide-listing-body-margin-end: $grid-body-margin-end !default;
$grid-float-wide-listing-sidebar-margin: $grid-page-margin-float !default;
$grid-float-wide-listing-margin-margin: $grid-page-margin-float !default;

// Sidebars
$grid-float-wide-listing-sidebar-column: $grid-float-sidebar-column !default;
$grid-float-wide-listing-sidebar-seg1: minmax(
  #{0.1 * $grid-float-wide-listing-sidebar-column},
  #{0.2 * $grid-float-wide-listing-sidebar-column}
) !default;
$grid-float-wide-listing-sidebar-seg2: minmax(
  #{0.2 * $grid-float-wide-listing-sidebar-column},
  #{0.6 * $grid-float-wide-listing-sidebar-column}
) !default;
$grid-float-wide-listing-sidebar-seg3: minmax(
  #{0.1 * $grid-float-wide-listing-sidebar-column},
  #{0.2 * $grid-float-wide-listing-sidebar-column}
) !default;

// Margins
$grid-float-wide-listing-margin-column: $grid-float-margin-column !default;
$grid-float-wide-listing-margin-seg3: minmax(
  #{0.1 * $grid-float-wide-listing-margin-column},
  #{0.2 * $grid-float-wide-listing-margin-column}
) !default;
$grid-float-wide-listing-margin-seg2: minmax(
  #{0.2 * $grid-float-wide-listing-margin-column},
  #{0.6 * $grid-float-wide-listing-margin-column}
) !default;
$grid-float-wide-listing-margin-seg1: minmax(
  #{0.1 * $grid-float-wide-listing-margin-column},
  #{0.2 * $grid-float-wide-listing-margin-column}
) !default;

// Body
$grid-float-wide-listing-body-column-min: $grid-body-column-min !default;
$grid-float-wide-listing-body-column-max: $grid-body-column-max !default;
$grid-float-wide-listing-body: minmax(
  $grid-float-wide-listing-body-column-min,
  calc(
    #{$grid-float-wide-listing-body-column-max} - #{$grid-float-wide-listing-page-margin-start +
      $grid-float-wide-listing-page-margin-end}
  )
) !default;

/* Float Mid Default Grid */
// Margins
$grid-float-mid-page-margin-start: $grid-page-margin-start !default;
$grid-float-mid-page-margin-end: $grid-page-margin-end !default;
$grid-float-mid-body-margin-start: $grid-body-margin-start !default;
$grid-float-mid-body-margin-end: $grid-body-margin-end !default;
$grid-float-mid-sidebar-margin: $grid-page-margin-float !default;
$grid-float-mid-margin-margin: $grid-page-margin-float !default;

// No sidebar, only margins
$grid-float-mid-margin-column: $grid-float-margin-column !default;
$grid-float-mid-margin-seg3: 0.2 * $grid-float-mid-margin-column !default;
$grid-float-mid-margin-seg2: minmax(
  #{0.3 * $grid-float-mid-margin-column},
  #{0.6 * $grid-float-mid-margin-column}
) !default;
$grid-float-mid-margin-seg1: 0.1 * $grid-float-mid-margin-column !default;

// Body
$grid-float-mid-body-column-min: $grid-body-column-min !default;
$grid-float-mid-body-column-max: $grid-body-column-max - 50px !default;
$grid-float-mid-body: minmax(
  $grid-float-mid-body-column-min,
  calc(
    #{$grid-float-mid-body-column-max} - #{$grid-float-mid-page-margin-start + $grid-float-mid-page-margin-end}
  )
) !default;

/* Float Mid Slim Content Grid */
// Margins
$grid-float-mid-slim-page-margin-start: $grid-page-margin-start !default;
$grid-float-mid-slim-page-margin-end: $grid-page-margin-end !default;
$grid-float-mid-slim-body-margin-start: 2 * $grid-body-margin-start / 3 !default;
$grid-float-mid-slim-body-margin-end: $grid-body-margin-end !default;
$grid-float-mid-slim-sidebar-margin: $grid-page-margin-float !default;
$grid-float-mid-slim-margin-margin: 0.8 * $grid-page-margin-float !default;

// No sidebar, only margins
$grid-float-mid-slim-margin-column: $grid-float-margin-column !default;
$grid-float-mid-slim-margin-seg3: 0.14 * $grid-float-mid-slim-margin-column !default;
$grid-float-mid-slim-margin-seg2: minmax(
  #{0.3 * $grid-float-mid-slim-margin-column},
  #{0.58 * $grid-float-mid-slim-margin-column}
) !default;
$grid-float-mid-slim-margin-seg1: 0.14 * $grid-float-mid-slim-margin-column !default;

// Body
$grid-float-mid-slim-body-column-min: $grid-body-column-min !default;
$grid-float-mid-slim-body-column-max: $grid-body-column-max - 50px !default;
$grid-float-mid-slim-body: minmax(
  $grid-float-mid-slim-body-column-min,
  calc(
    #{$grid-float-mid-slim-body-column-max} - #{$grid-float-mid-slim-page-margin-start +
      $grid-float-mid-slim-page-margin-end}
  )
) !default;

/* Float Mid Full Content Grid */
// Margins
$grid-float-mid-full-page-margin-start: $grid-page-margin-start !default;
$grid-float-mid-full-page-margin-end: $grid-page-margin-end !default;
$grid-float-mid-full-body-margin-start: 2 * $grid-body-margin-start / 3 !default;
$grid-float-mid-full-body-margin-end: $grid-body-margin-end !default;
$grid-float-mid-full-sidebar-margin: $grid-page-margin-float !default;
$grid-float-mid-full-margin-margin: 0.8 * $grid-page-margin-float !default;

// No sidebar or margins

// Body
$grid-float-mid-full-body-column-min: $grid-body-column-min !default;
$grid-float-mid-full-body-column-max: $grid-body-column-max !default;
$grid-float-mid-full-body: minmax(
  $grid-float-mid-full-body-column-min,
  calc(
    #{$grid-float-mid-full-body-column-max} - #{$grid-float-mid-full-page-margin-start +
      $grid-float-mid-full-page-margin-end}
  )
) !default;

/* Float Mid Listing Content Grid */
// Margins
$grid-float-mid-listing-page-margin-start: $grid-page-margin-start !default;
$grid-float-mid-listing-page-margin-end: $grid-page-margin-end !default;
$grid-float-mid-listing-body-margin-start: 2 * $grid-body-margin-start / 3 !default;
$grid-float-mid-listing-body-margin-end: $grid-body-margin-end !default;
$grid-float-mid-listing-sidebar-margin: $grid-page-margin-float !default;
$grid-float-mid-listing-margin-margin: 0.8 * $grid-page-margin-float !default;

// No sidebar, only margins
$grid-float-mid-listing-margin-column: $grid-float-margin-column !default;
$grid-float-mid-listing-margin-seg3: 0.2 * $grid-float-mid-listing-margin-column !default;
$grid-float-mid-listing-margin-seg2: minmax(
  #{0.3 * $grid-float-mid-listing-margin-column},
  #{0.6 * $grid-float-mid-listing-margin-column}
) !default;
$grid-float-mid-listing-margin-seg1: 0.1 * $grid-float-mid-listing-margin-column !default;

// Body
$grid-float-mid-listing-body-column-min: $grid-body-column-min !default;
$grid-float-mid-listing-body-column-max: $grid-body-column-max - 50px !default;
$grid-float-mid-listing-body: minmax(
  $grid-float-mid-listing-body-column-min,
  calc(
    #{$grid-float-mid-listing-body-column-max} - #{$grid-float-mid-listing-page-margin-start +
      $grid-float-mid-listing-page-margin-end}
  )
) !default;
