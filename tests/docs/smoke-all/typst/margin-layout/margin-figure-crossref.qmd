---
title: "Margin Figure Cross-ref Test"
papersize: us-letter
format:
  html: default
  typst:
    keep-typ: true
_quarto:
  tests:
    typst:
      ensureTypstFileRegexMatches:
        - ['#notefigure\(', '<fig-test>']
        - []
      ensurePdfTextPositions:
        - # Caption in margin, right of body
          - subject: "CROSSREF-FIG-CAP"
            relation: rightOf
            object: "This tests"
          # Plot content (★ marker) in margin
          - subject: "★"
            relation: rightOf
            object: "This tests"
          # Caption below plot
          - subject: "★"
            relation: above
            object: "CROSSREF-FIG-CAP"
        - []
      noErrors: default
---

This tests cross-references to margin figures.

![CROSSREF-FIG-CAP](test-plot.svg){#fig-test .column-margin width=100%}

As shown in @fig-test, the figure appears in the margin with a working cross-reference.

The reference should show "Figure 1" or similar.
