---
title: "Margin Listing with Caption Below"
papersize: us-letter
grid:
  margin-width: 3.5in
  gutter-width: 0.25in
format:
  html: default
  typst:
    keep-typ: true
_quarto:
  tests:
    typst:
      ensureTypstFileRegexMatches:
        # Cell option produces #notefigure with position: bottom
        - ['#notefigure\(', 'kind: "quarto-float-lst"', 'position: bottom']
        - []
      ensurePdfRegexMatches:
        - ['Listing 1', 'MARGINLISTBELOW']
        - []
      ensurePdfTextPositions:
        - # Listing in margin, right of body text - "World" unique string in code
          - subject: "MARGINLISTBELOW"
            relation: rightOf
            object: "This tests"
          - subject: "World"
            relation: rightOf
            object: "This tests"
          # Caption BELOW code (lst-cap-location: bottom)
          - subject: "World"
            relation: above
            object: "MARGINLISTBELOW"
        - []
      noErrors: default
---

This tests a code listing in the margin with caption below using `cap-location: bottom`.

```{python}
#| column: margin
#| label: lst-margin-below
#| lst-cap: "MARGINLISTBELOW"
#| lst-cap-location: bottom
#| echo: true
#| eval: false

def greet(name):
    """Simple greeting function"""
    return f"Hello, {name}!"

print(greet("World"))
```

As shown in @lst-margin-below, the listing should appear in the margin with caption below the code.

More text in the main column to demonstrate the layout.
